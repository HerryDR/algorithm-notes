### **51. N çš‡å**

------

#### ğŸ§¾ é¢˜ç›®æè¿°

åœ¨ nÃ—nn \times n çš„æ£‹ç›˜ä¸Šæ”¾ç½® nn ä¸ªçš‡åï¼Œä½¿å…¶äº’ä¸æ”»å‡»ï¼ˆåŒä¸€è¡Œã€åŒä¸€åˆ—ã€ä»»ä¸€å¯¹è§’çº¿ä¸Šæœ€å¤šåªæœ‰ä¸€ä¸ªçš‡åï¼‰ã€‚è¿”å›æ‰€æœ‰åˆæ³•çš„æ”¾ç½®æ–¹æ¡ˆï¼Œæ ¼å¼ä¸ºï¼šæ¯ç§æ–¹æ¡ˆæ˜¯ä¸€ç»„ nn è¡Œå­—ç¬¦ä¸²ï¼Œæ¯è¡Œé•¿åº¦ä¸º nnï¼Œå­—ç¬¦ `'Q'` è¡¨ç¤ºçš‡åï¼Œ`'.'` è¡¨ç¤ºç©ºä½ã€‚

------

#### ğŸ’¡ è§£é¢˜æ€è·¯

ä½¿ç”¨ **å›æº¯ï¼ˆBacktrackingï¼‰** æšä¸¾æ¯ä¸€è¡Œçš‡åçš„ä½ç½®ï¼š

1. **æ£‹ç›˜çŠ¶æ€**

   - ç”¨ `char[][] chessboard` æ¥è¡¨ç¤ºå½“å‰å¸ƒå±€ï¼Œ`'.'` ä¸ºç©ºï¼Œ`'Q'` ä¸ºçš‡åã€‚

2. **å›æº¯å˜é‡**

   - `row`ï¼šå½“å‰è¦æ”¾ç½®çš‡åçš„è¡Œå·ï¼Œä» `0` å¼€å§‹åˆ° `n-1`ã€‚

3. **é€’å½’æ¡†æ¶**

   ```text
   backtracking(row):
     if row == n:                // å·²æ”¾å®Œ n è¡Œ
       record å½“å‰ chessboard â†’ result
       return
     for each col in [0..n-1]:
       if legal(row, col):
         chessboard[row][col] = 'Q'
         backtracking(row + 1)
         chessboard[row][col] = '.'  // æ’¤é”€
   ```

4. **åˆæ³•æ€§æ£€æŸ¥ `legal(row, col)`**

   - **åŒåˆ—å†²çª**ï¼šæ£€æŸ¥ `0â€¦row-1` è¡Œçš„åŒä¸€åˆ—æ˜¯å¦æœ‰ `'Q'`ã€‚
   - **å·¦ä¸Šå¯¹è§’çº¿**ï¼šæ£€æŸ¥ `(row-1, col-1)ã€(row-2, col-2)â€¦` æ˜¯å¦æœ‰ `'Q'`ã€‚
   - **å³ä¸Šå¯¹è§’çº¿**ï¼šæ£€æŸ¥ `(row-1, col+1)ã€(row-2, col+2)â€¦` æ˜¯å¦æœ‰ `'Q'`ã€‚

5. **ç»“æœæ”¶é›† `ArrayToList()`**
    æŠŠ `chessboard` è½¬ä¸º `List<String>` å¹¶åŠ å…¥ `result`ï¼š

   ```java
   List<String> board = new ArrayList<>();
   for (int i = 0; i < n; i++) {
     board.add(new String(chessboard[i]));
   }
   result.add(board);
   ```

------

#### âœ… ä»£ç å®ç°ï¼ˆå¸¦ä¸­æ–‡æ³¨é‡Šï¼‰

```java
class Solution {
    private List<List<String>> result = new ArrayList<>();
    private char[][] chessboard;

    public List<List<String>> solveNQueens(int n) {
        // åˆå§‹åŒ– nÃ—n æ£‹ç›˜ï¼Œå…¨éƒ¨è®¾ä¸ºç©º
        chessboard = new char[n][n];
        for (int i = 0; i < n; i++) {
            Arrays.fill(chessboard[i], '.');
        }
        // ä»ç¬¬ 0 è¡Œå¼€å§‹å›æº¯
        backtracking(n, 0);
        return result;
    }

    /**
     * åœ¨ç¬¬ row è¡Œæ”¾ç½®çš‡å
     * @param n     æ£‹ç›˜å¤§å°
     * @param row   å½“å‰æ”¾ç½®çš„è¡Œ
     */
    private void backtracking(int n, int row) {
        // ç»ˆæ­¢ï¼šå·²ç»æ”¾å®Œæ‰€æœ‰è¡Œ
        if (row == n) {
            ArrayToList(n);
            return;
        }
        // å°è¯•åœ¨ row è¡Œçš„æ¯ä¸€åˆ— j æ”¾çš‡å
        for (int j = 0; j < n; j++) {
            if (legal(row, j, n)) {
                // é€‰æ‹©
                chessboard[row][j] = 'Q';
                // é€’å½’åˆ°ä¸‹ä¸€è¡Œ
                backtracking(n, row + 1);
                // å›æº¯ï¼Œæ’¤é”€é€‰æ‹©
                chessboard[row][j] = '.';
            }
        }
    }

    /**
     * å°†å½“å‰ chessboard è½¬ä¸º List<String> å¹¶åŠ å…¥ result
     * @param n   æ£‹ç›˜å¤§å°
     */
    private void ArrayToList(int n) {
        List<String> board = new ArrayList<>();
        for (int i = 0; i < n; i++) {
            // æ¯è¡Œç”¨ char[] æ„é€  String
            board.add(new String(chessboard[i]));
        }
        result.add(board);
    }

    /**
     * æ£€æŸ¥åœ¨ (row, col) æ”¾ç½®çš‡åæ˜¯å¦åˆæ³•
     * @param row   è¡Œå·
     * @param col   åˆ—å·
     * @param n     æ£‹ç›˜å¤§å°
     * @return      true å¦‚æœä¸å†²çª
     */
    private boolean legal(int row, int col, int n) {
        // ï¼ˆ1ï¼‰åŒåˆ—æ£€æŸ¥
        for (int i = 0; i < row; i++) {
            if (chessboard[i][col] == 'Q') return false;
        }
        // ï¼ˆ2ï¼‰å·¦ä¸Šå¯¹è§’çº¿
        for (int i = row - 1, j = col - 1; i >= 0 && j >= 0; i--, j--) {
            if (chessboard[i][j] == 'Q') return false;
        }
        // ï¼ˆ3ï¼‰å³ä¸Šå¯¹è§’çº¿
        for (int i = row - 1, j = col + 1; i >= 0 && j < n; i--, j++) {
            if (chessboard[i][j] == 'Q') return false;
        }
        return true;
    }
}
```

------

#### â± å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š
   å›æº¯éå†æ‰€æœ‰å¯èƒ½æ‘†æ”¾ï¼Œæœ€åçº¦ O(n!)O(n!)ï¼›æ¯æ¬¡æ£€æŸ¥åˆæ³•æ€§ O(n)O(n)ï¼›æ¯æ¬¡è®°å½•ç»“æœä¹Ÿ O(n2)O(n^2)ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š
  - æ£‹ç›˜ `O(n^2)`ï¼›
  - é€’å½’æ ˆæ·±åº¦ `O(n)`ï¼›
  - ç»“æœé›†ä¾ç…§æ–¹æ¡ˆæ•°è§„æ¨¡ã€‚

------

#### ğŸ”š å°ç»“

- ä½¿ç”¨äºŒç»´æ•°ç»„ç›´è§‚ç»´æŠ¤æ£‹ç›˜çŠ¶æ€ï¼›
- åˆæ³•æ€§æ£€æŸ¥éå†ä¸Šæ–¹ã€å·¦ä¸Šã€å³ä¸Šä¸‰æ¡æ–¹å‘ï¼›
- æ¯è¡Œæ‹¼å‡º `'.'`/`'Q'` å†é€’å½’ï¼Œå›æº¯æ—¶åŠæ—¶æ’¤é”€ã€‚

è¿™æ ·å°±èƒ½æšä¸¾å¹¶è¾“å‡ºæ‰€æœ‰ N çš‡åè§£æ³•ã€‚